<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>India Weather Explorer - Live Climate Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&display=swap');
        
        :root {
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.3);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
            min-height: 100vh;
            transition: background 1s ease;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 1.5rem;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 250px;
            max-height: 300px;
        }

        .weather-gradient-clear { background: linear-gradient(to bottom right, #fde68a, #fbbf24); }
        .weather-gradient-rain { background: linear-gradient(to bottom right, #93c5fd, #3b82f6); }
        .weather-gradient-cloudy { background: linear-gradient(to bottom right, #cbd5e1, #64748b); }

        .indian-city-pill:hover {
            transform: translateY(-2px);
            background: #4f46e5;
            color: white;
        }

        @keyframes pulse-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .live-indicator { animation: pulse-soft 2s infinite; }
    </style>
    <!-- Chosen Palette: Sky Blue, Amber (Sun), Slate (Clouds), Indigo (Accents) -->
    <!-- Application Structure Plan:
         1. Header: Search bar + Quick Select for major Indian Metro cities.
         2. Hero: Current weather for selected city with "Indian Climate Insight" (e.g., Heatwave warnings, Humidity levels).
         3. Analytics: 24-hour temperature chart (Chart.js).
         4. Details: Grid of metrics like UV Index, Wind Speed, and Rain probability.
         5. Methodology: Simple explanation of where data comes from.
    -->
    <!-- Visualization & Content Choices:
         1. Line Chart: Shows 24-hour forecast. Goal: Change/Trend.
         2. Status Cards: Uses icons and bold text for Air Quality (mock) and Humidity. Goal: Inform.
         3. Quick-select pills: Optimized for mobile thumb navigation.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <!-- Header & Search -->
        <header class="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-6">
            <div>
                <h1 class="text-3xl font-bold text-slate-900 flex items-center">
                    <i class="fas fa-cloud-sun-rain mr-3 text-indigo-600"></i>
                    Bharat Weather <span class="text-indigo-600">Live</span>
                </h1>
                <p class="text-slate-500 mt-1" id="current-date-display">Updating live data...</p>
            </div>
            
            <div class="relative w-full md:w-96 group">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-indigo-500 transition-colors"></i>
                <input type="text" id="citySearch" placeholder="Search Indian cities (e.g. Pune)..." 
                       class="w-full pl-12 pr-4 py-3 glass-card focus:outline-none focus:ring-2 focus:ring-indigo-500/50 border-none">
            </div>
        </header>

        <!-- Quick Select Cities -->
        <div class="flex flex-wrap gap-2 mb-8 overflow-x-auto pb-2 scrollbar-hide">
            <button onclick="weatherApp.fetchData(28.61, 77.20, 'New Delhi')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">New Delhi</button>
            <button onclick="weatherApp.fetchData(19.07, 72.87, 'Mumbai')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">Mumbai</button>
            <button onclick="weatherApp.fetchData(12.97, 77.59, 'Bengaluru')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">Bengaluru</button>
            <button onclick="weatherApp.fetchData(13.08, 80.27, 'Chennai')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">Chennai</button>
            <button onclick="weatherApp.fetchData(22.57, 88.36, 'Kolkata')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">Kolkata</button>
            <button onclick="weatherApp.fetchData(17.38, 78.48, 'Hyderabad')" class="indian-city-pill px-5 py-2 glass-card text-sm font-semibold transition-all">Hyderabad</button>
        </div>

        <!-- Main Dashboard -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Hero Card: Current Weather -->
            <div class="lg:col-span-1 space-y-6">
                <div id="hero-card" class="glass-card p-8 text-center relative overflow-hidden transition-all duration-500">
                    <div class="relative z-10">
                        <div class="flex items-center justify-center mb-4">
                            <span class="bg-indigo-600 text-white text-[10px] uppercase font-bold px-2 py-1 rounded-full live-indicator">Live</span>
                        </div>
                        <h2 id="display-city" class="text-4xl font-bold text-slate-900 mb-2">New Delhi</h2>
                        <div class="text-7xl font-bold text-slate-900 my-6 tracking-tight">
                            <span id="display-temp">--</span><span class="text-indigo-600">°C</span>
                        </div>
                        <div id="display-condition" class="text-xl font-semibold text-slate-700 capitalize">Clear Skies</div>
                        <div class="mt-8 grid grid-cols-2 gap-4 border-t border-slate-200/50 pt-6">
                            <div>
                                <p class="text-xs text-slate-400 uppercase font-bold">High / Low</p>
                                <p class="text-sm font-semibold text-slate-800"><span id="display-high">--</span>° / <span id="display-low">--</span>°</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 uppercase font-bold">Real Feel</p>
                                <p class="text-sm font-semibold text-slate-800"><span id="display-feel">--</span>°C</p>
                            </div>
                        </div>
                    </div>
                    <!-- Decorative Background element -->
                    <div id="weather-icon-bg" class="absolute -bottom-10 -right-10 opacity-10 text-9xl transform -rotate-12">
                        <i class="fas fa-sun"></i>
                    </div>
                </div>

                <!-- Climate Insight Box (Specific to India) -->
                <div class="glass-card p-6 border-l-4 border-amber-500">
                    <h3 class="font-bold text-slate-800 flex items-center mb-2">
                        <i class="fas fa-lightbulb text-amber-500 mr-2"></i>
                        Indian Climate Insight
                    </h3>
                    <p id="climate-insight" class="text-sm text-slate-600 leading-relaxed">
                        Data is being analyzed for typical Indian weather patterns including heat index and seasonal shifts.
                    </p>
                </div>
            </div>

            <!-- Detailed Stats & Charts -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Analytics Card -->
                <div class="glass-card p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="font-bold text-lg text-slate-800">24-Hour Forecast</h3>
                        <span class="text-xs text-slate-400">Hourly Trend</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="tempChart"></canvas>
                    </div>
                </div>

                <!-- Metrics Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="glass-card p-4 text-center">
                        <i class="fas fa-droplet text-blue-500 mb-2 text-xl"></i>
                        <p class="text-xs text-slate-400 uppercase font-bold">Humidity</p>
                        <p class="text-lg font-bold text-slate-800" id="stat-humidity">--%</p>
                    </div>
                    <div class="glass-card p-4 text-center">
                        <i class="fas fa-wind text-indigo-400 mb-2 text-xl"></i>
                        <p class="text-xs text-slate-400 uppercase font-bold">Wind Speed</p>
                        <p class="text-lg font-bold text-slate-800" id="stat-wind">-- km/h</p>
                    </div>
                    <div class="glass-card p-4 text-center">
                        <i class="fas fa-sun text-amber-500 mb-2 text-xl"></i>
                        <p class="text-xs text-slate-400 uppercase font-bold">UV Index</p>
                        <p class="text-lg font-bold text-slate-800" id="stat-uv">--</p>
                    </div>
                    <div class="glass-card p-4 text-center">
                        <i class="fas fa-cloud-showers-heavy text-slate-400 mb-2 text-xl"></i>
                        <p class="text-xs text-slate-400 uppercase font-bold">Rain Chance</p>
                        <p class="text-lg font-bold text-slate-800" id="stat-rain">--%</p>
                    </div>
                </div>

                <!-- Footer / Info -->
                <div class="text-center text-slate-400 text-xs py-4">
                    <p>Powered by Open-Meteo API. Optimized for Indian Standard Time (IST).</p>
                    <p class="mt-1">No SVG used. Responsive Layout. Pure Canvas Data Viz.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Error/Notice Toast -->
    <div id="toast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-6 py-3 rounded-full shadow-2xl transition-all duration-300 opacity-0 pointer-events-none z-50">
        City not found. Showing default data.
    </div>

    <script>
        const weatherApp = {
            chart: null,
            
            init() {
                this.updateDate();
                this.fetchData(28.61, 77.20, 'New Delhi'); // Default to Capital
                this.setupSearch();
            },

            updateDate() {
                const now = new Date();
                const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
                document.getElementById('current-date-display').innerText = now.toLocaleDateString('en-IN', options);
            },

            setupSearch() {
                const search = document.getElementById('citySearch');
                search.addEventListener('keypress', async (e) => {
                    if (e.key === 'Enter') {
                        const city = search.value.trim();
                        if (city) this.searchCity(city);
                    }
                });
            },

            async searchCity(city) {
                try {
                    const res = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${city}&count=1&language=en&format=json`);
                    const data = await res.json();
                    if (data.results && data.results.length > 0) {
                        const result = data.results[0];
                        this.fetchData(result.latitude, result.longitude, result.name);
                    } else {
                        this.showToast();
                    }
                } catch (err) {
                    this.showToast();
                }
            },

            showToast() {
                const toast = document.getElementById('toast');
                toast.classList.remove('opacity-0');
                setTimeout(() => toast.classList.add('opacity-0'), 3000);
            },

            async fetchData(lat, lon, cityName) {
                try {
                    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,relative_humidity_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m&hourly=temperature_2m&daily=temperature_2m_max,temperature_2m_min,uv_index_max,precipitation_probability_max&timezone=auto`);
                    const data = await res.json();
                    this.renderUI(data, cityName);
                } catch (err) {
                    console.error("Failed to fetch weather data", err);
                }
            },

            getWeatherLabel(code) {
                const codes = {
                    0: ["Clear Sky", "fa-sun"],
                    1: ["Mainly Clear", "fa-cloud-sun"],
                    2: ["Partly Cloudy", "fa-cloud-sun"],
                    3: ["Overcast", "fa-cloud"],
                    45: ["Foggy", "fa-smog"],
                    51: ["Drizzle", "fa-cloud-rain"],
                    61: ["Slight Rain", "fa-cloud-showers-heavy"],
                    71: ["Slight Snow", "fa-snowflake"],
                    95: ["Thunderstorm", "fa-bolt"]
                };
                return codes[code] || ["Cloudy", "fa-cloud"];
            },

            updateTheme(code) {
                const body = document.body;
                if (code <= 1) body.style.background = "linear-gradient(135deg, #fef3c7 0%, #fffbeb 100%)"; // Sunny
                else if (code > 1 && code < 51) body.style.background = "linear-gradient(135deg, #e2e8f0 0%, #f8fafc 100%)"; // Cloudy
                else body.style.background = "linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%)"; // Rainy
            },

            generateInsight(temp, humidity, rainChance) {
                let insight = "";
                if (temp > 40) insight = "CRITICAL: Heatwave conditions expected. Stay hydrated and avoid outdoor activities during noon.";
                else if (temp > 32 && humidity > 70) insight = "HIGH HUMIDITY: Real-feel temperature is significantly higher. Wear breathable cotton fabrics.";
                else if (rainChance > 50) insight = "MONSOON ALERT: High chance of rainfall. Carry an umbrella and check for local water-logging.";
                else if (temp < 15) insight = "WINTER COOL: Pleasant weather, but early mornings might be chilly. Light woolens recommended.";
                else insight = "PLEASANT: Ideal weather for local travel and outdoor activities in the region.";
                
                document.getElementById('climate-insight').innerText = insight;
            },

            renderUI(data, cityName) {
                const current = data.current;
                const daily = data.daily;
                const [condition, icon] = this.getWeatherLabel(current.weather_code);

                // Update Hero
                document.getElementById('display-city').innerText = cityName;
                document.getElementById('display-temp').innerText = Math.round(current.temperature_2m);
                document.getElementById('display-condition').innerText = condition;
                document.getElementById('display-high').innerText = Math.round(daily.temperature_2m_max[0]);
                document.getElementById('display-low').innerText = Math.round(daily.temperature_2m_min[0]);
                document.getElementById('display-feel').innerText = Math.round(current.apparent_temperature);
                
                // Update Icon Background
                const iconBg = document.getElementById('weather-icon-bg');
                iconBg.innerHTML = `<i class="fas ${icon}"></i>`;
                
                // Update Stats
                document.getElementById('stat-humidity').innerText = `${current.relative_humidity_2m}%`;
                document.getElementById('stat-wind').innerText = `${current.wind_speed_10m} km/h`;
                document.getElementById('stat-uv').innerText = daily.uv_index_max[0];
                document.getElementById('stat-rain').innerText = `${daily.precipitation_probability_max[0]}%`;

                this.updateTheme(current.weather_code);
                this.generateInsight(current.temperature_2m, current.relative_humidity_2m, daily.precipitation_probability_max[0]);
                this.renderChart(data.hourly.temperature_2m.slice(0, 24));
            },

            renderChart(temps) {
                const ctx = document.getElementById('tempChart').getContext('2d');
                const labels = Array.from({length: 24}, (_, i) => `${i}:00`);

                if (this.chart) this.chart.destroy();

                this.chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Temp (°C)',
                            data: temps,
                            borderColor: '#4f46e5',
                            backgroundColor: 'rgba(79, 70, 229, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        },
                        scales: {
                            x: {
                                grid: { display: false },
                                ticks: { maxRotation: 0, autoSkip: true, maxTicksLimit: 8 }
                            },
                            y: {
                                grid: { color: 'rgba(0,0,0,0.05)' }
                            }
                        }
                    }
                });
            }
        };

        // Boot
        window.onload = () => weatherApp.init();
    </script>
</body>
</html>